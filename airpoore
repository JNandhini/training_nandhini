#pragma warning(disable:4996)#include "Airport.h" //Airport airport;Request request;
void Airport::get_details()
{
cout << "Enter the Airport Name" << endl; 
cout << "The Airport Name is" << endl;
cin.ignore();
getline(cin, AirportName);
cout << endl
;
}
void Airport::request_generation()
{ 
std::chrono::time_point<std::chrono::system_clock> start;
srand(time(0)); 
chrono::seconds minutes((rand()%9)+10); 
string first[1] = { "Air" }; 
string second[4] = { "ways", "line", "india", "jet" };        
        FlightTime=(rand()%9)+10;
        this_thread::sleep_for(chrono::seconds(FlightTime)); 
        start = std::chrono::system_clock::now();
        time_t StartTime = std::chrono::system_clock::to_time_t(start);
        cout << endl << ctime(&StartTime); 
        request.FlightId = (rand() % 9000) + 1000;
        request.FlightTime=StartTime;
        cout << "The flight id is" << endl;
        cout << request.FlightId; request.set_flightid(request.FlightId); 
        state1 = rand() % 2;
        if (state1 == 0)
        {
        request.state = "takeoff";  
        }
        else
        {
        request.state = "landing"; 
        } 
        cout << "\nThe state of the flight is"; 
        cout << endl << request.state; request.set_flightstate(request.state);
        request.FlightName = first[rand() % 1] + second[rand() % 4];
        request.set_flightname(request.FlightName); 
        cout << "\nThe flight id " << request.FlightId << " is requesting for runnway\n";
        cout << "The request Time is " << ctime(&StartTime); 
        request.set_flighttime(request.FlightTime);
        cout << "Time" << endl << StartTime; 
        cout << "The flightname is " << request.FlightName << endl;
        if (request.state == "landing")   
        {  
        queue.push(request);
        } 
        else
        {
        queue.push(request);
        }
  count++; 
  }
  int Airport::allocation_of_runway()
{
 chrono::seconds min(9); 
 
 std::chrono::time_point<std::chrono::system_clock>start,starttime,startdur, end;
 start = chrono::system_clock::now();
 static int CheckTime=0;
 static int duration=0;
if (!queue.landing.empty())
 {  
         if (runway1 == idle)  
         {
         runway1 = 1;// queue.landing[iterate].get_flightid(); 
         cout << "Runway1 is allocated to landing queue\n";// << queue.landing[iterate].get_flightid() << endl;
         iterate++;
         //queue.pop();
         queue.pop();  
         time_t rawtime;      
         time(&rawtime);
         CheckTime=rawtime;
         start = chrono::system_clock::now();    
         std::time_t start_time = std::chrono::system_clock::to_time_t(start);
         end = chrono::system_clock::now()+min; 
         chrono::duration <double>elapse_time = start_time - request.FlightTime; 
         cout << endl << elapse_time.count();  
        }  
        else if (runway2 == idle) 
        {  
        runway2 = 1;// queue.landing[iterator].get_flightid();  
        cout << "Runway2 is allocated to landing queue";// << queue.landing[iterator].get_flightid() << endl; 
        starttime = chrono::system_clock::now();
        iterate++; 
        cout << iterator;  
        queue.pop();
        time_t rawtime;
        time(&rawtime);
        duration=rawtime;
        cout << "iterator" << iterator;  
        end = chrono::system_clock::now(); 
        std::time_t Starttime = std::chrono::system_clock::to_time_t(starttime);   
        chrono::duration <double>elapsed_time = Starttime- request.FlightTime;
        cout << endl << elapsed_time.count(); 
        }
        }
　　 else if (!queue.takeoff.empty()) 
   {
   if (runway1 == idle)
   {
   runway1 = 1;// queue.takeoff[iterator].get_flightid(); 
   cout << "Runway1 is allocated to takeoff queue\n";// << queue.takeoff[iterator].get_flightid() << endl;   
   start = chrono::system_clock::now(); 
   iterator++;  
   //queue.pop();    
   queue.pop();
   time_t rawtime;
   time(&rawtime);
   ChechkTime=rawtime;
   std::time_t start_time = std::chrono::system_clock::to_time_t(start); 
   end = chrono::system_clock::now();
   chrono::duration <double>elapse_time = start_time - request.FlightTime;  
   }
   }
　　   else if (runway2 == idle)  
     {
     runway2 = 1;// queue.takeoff[iterate].get_flightid();
     cout << "Runway2 is allocated to takeoff queue\n";// << queue.takeoff[iterate].get_flightid() << endl;   
     starttime = chrono::system_clock::now();
     queue.pop();
     std::time_t Start_time = std::chrono::system_clock::to_time_t(starttime);
     iterator++;   
     cout << iterate; 
     time_t rawtime;            
     time(&rawtime); 
     duration=rawtime;
     end = chrono::system_clock::now();   
     chrono::duration <double>elapse_time =  Start_time-request.FlightTime;   
     cout << endl << elapse_time.count(); 
     }
     }
     time_t rawtime;             
     time(&rawtime); 
     if(rawtime==CheckTime) 
     {
     CheckTime=0;
     cout << "hai" << endl;
     runway1 = 0;
     return 0;
     }
     else if (rawtime==duration) 
     {
     duration=0;
     runway2 = 0;  
     return 0;
     }
     if (rawtime==CheckTime)
     {
     CheckTime=0;
     runway1 = 0;
     return 0;
     }
     else if (rawtime==duration) 
     {
     duration=0;
     runway2 = 0;
     return 0; 
     }
　}
 #pragma warning(disable:4996)
 #include"Airport.h"
 #include<future>
 Airport airport;
　void call();
 void calling();
int main()
{
Airport airport;  
airport.get_details(); 
async(call);
async(calling);
airport.queue.display();
system("pause");
cin.ignore(1000,'\n');
}
void call()
{
std::chrono::seconds minute(90);
std::chrono::time_point<std::chrono::system_clock>start, end;
start = chrono::system_clock::now(); 
std::time_t start_time = std::chrono::system_clock::to_time_t(start);
cout << ctime(&start_time); 
end = std::chrono::system_clock::now() + minute; 
std::time_t end_time = std::chrono::system_clock::to_time_t(end);
 while (std::chrono::system_clock::now() < end)
 {
 airport.request_generation();
 }
}
void calling()
{
std::chrono::seconds minute(9); 
std::chrono::time_point<std::chrono::system_clock>start, end; 
start = chrono::system_clock::now(); 
std::time_t start_time = std::chrono::system_clock::to_time_t(start);
cout << ctime(&start_time);
end = std::chrono::system_clock::now() + minute; 
std::time_t end_time = std::chrono::system_clock::to_time_t(end);
while (std::chrono::system_clock::now() < end)
{
airport.allocation_of_runway();
}
}
 
